{% extends "base.html" %}

{% block title %}–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ - –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∏{% endblock %}

{% block content %}
<div class="equipment-catalog">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ -->
    <div class="catalog-header">
        <h1>üîß –ö–∞—Ç–∞–ª–æ–≥ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</h1>
        <p class="catalog-description">–°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–æ–∫ –≤ –æ–±–ª–∞—Å—Ç–∏ —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∏</p>
    </div>

    <!-- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤) -->
    {% if user and user.role == 'admin' %}
    <div class="admin-panel">
        <div class="admin-header">
            <h2><i class="fas fa-user-shield"></i> –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h2>
            <div class="admin-stats">
                <span class="admin-badge">–í—Å–µ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è: {{ equipment_count }}</span>
                <span class="admin-badge">–î–æ—Å—Ç—É–ø–Ω–æ: {{ available_count }}</span>
                <span class="admin-badge">–ó–∞–Ω—è—Ç–æ/–†–µ–º–æ–Ω—Ç: {{ busy_count }}</span>
            </div>
        </div>
        
        <div class="admin-controls">
            <button class="btn btn-admin" onclick="showAddEquipmentModal()">
                <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
            </button>
            <button class="btn btn-admin" onclick="showMaintenanceModal()">
                <i class="fas fa-tools"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ–º
            </button>
            <a href="{{ url_for('admin_bookings') }}" class="btn btn-admin">
                <i class="fas fa-calendar-alt"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è–º–∏
            </a>
            <button class="btn btn-admin btn-export" onclick="exportEquipmentData()">
                <i class="fas fa-file-export"></i> –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
            </button>
        </div>

        <!-- –ë—ã—Å—Ç—Ä–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º -->
        <div class="quick-actions">
            <h3>–ë—ã—Å—Ç—Ä–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º:</h3>
            <div class="equipment-controls">
                {% for item in items %}
                <div class="equipment-control-item" data-id="{{ item.id }}">
                    <span class="equipment-name">{{ item.name }}</span>
                    <select class="status-select" onchange="updateEquipmentStatus({{ item.id }}, this.value)">
                        <option value="available" {% if item.is_available %}selected{% endif %}>–î–æ—Å—Ç—É–ø–Ω–æ</option>
                        <option value="busy" {% if not item.is_available %}selected{% endif %}>–ó–∞–Ω—è—Ç–æ</option>
                        <option value="maintenance">–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ</option>
                    </select>
                    <button class="btn btn-sm btn-edit" onclick="editEquipment({{ item.id }})">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="btn btn-sm btn-delete" onclick="confirmDeleteEquipment({{ item.id }}, '{{ item.name }}')">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
    {% endif %}

    <!-- –§–∏–ª—å—Ç—Ä—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º -->
    <div class="category-filters">
        <div class="filter-buttons">
            <button class="filter-btn active" data-category="all">
                <i class="fas fa-th-large"></i>
                –í—Å–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
            </button>
            <button class="filter-btn" data-category="workstation">
                <i class="fas fa-desktop"></i>
                –†–∞–±–æ—á–∏–µ –º–µ—Å—Ç–∞
            </button>
            <button class="filter-btn" data-category="3d">
                <i class="fas fa-print"></i>
                3D-–ø–µ—á–∞—Ç—å
            </button>
            <button class="filter-btn" data-category="robots">
                <i class="fas fa-robot"></i>
                –†–æ–±–æ–º–∞–Ω–∏–ø—É–ª—è—Ç–æ—Ä—ã
            </button>
            <button class="filter-btn" data-category="drones">
                <i class="fas fa-helicopter"></i>
                –ë–ü–õ–ê
            </button>
            <button class="filter-btn" data-category="cnc">
                <i class="fas fa-cog"></i>
                –ß–ü–£ —Å—Ç–∞–Ω–∫–∏
            </button>
        </div>
        
        <!-- –ü–æ–∏—Å–∫ -->
        <div class="search-box">
            <i class="fas fa-search"></i>
            <input type="text" id="equipmentSearch" placeholder="–ü–æ–∏—Å–∫ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è...">
        </div>
    </div>

    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    <div class="equipment-stats">
        <div class="stat-card">
            <div class="stat-icon available">
                <i class="fas fa-check-circle"></i>
            </div>
            <div class="stat-info">
                <span class="stat-number">{{ available_count }}</span>
                <span class="stat-label">–î–æ—Å—Ç—É–ø–Ω–æ</span>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon busy">
                <i class="fas fa-clock"></i>
            </div>
            <div class="stat-info">
                <span class="stat-number">{{ busy_count }}</span>
                <span class="stat-label">–ó–∞–Ω—è—Ç–æ/–†–µ–º–æ–Ω—Ç</span>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon total">
                <i class="fas fa-cubes"></i>
            </div>
            <div class="stat-info">
                <span class="stat-number">{{ equipment_count }}</span>
                <span class="stat-label">–í—Å–µ–≥–æ</span>
            </div>
        </div>
    </div>

    <!-- –°–µ—Ç–∫–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è -->
    <div class="equipment-grid" id="equipmentGrid">
        {% for item in items %}
        {% set category_name = item.category.name.lower() if item.category else '' %}
        {% set category_filter = 
            'workstation' if '—Ä–∞–±–æ—á' in category_name or 'workstation' in category_name or '–∫–æ–º–ø—å—é—Ç–µ—Ä' in category_name or 'desktop' in category_name
            else '3d' if '3d' in category_name or '–ø–µ—á–∞—Ç' in category_name or '–ø—Ä–∏–Ω—Ç–µ—Ä' in category_name or 'print' in category_name
            else 'robots' if '—Ä–æ–±–æ—Ç' in category_name or 'robot' in category_name or '–º–∞–Ω–∏–ø—É–ª—è—Ç–æ—Ä' in category_name
            else 'drones' if '–±–ø–ª–∞' in category_name or '–¥—Ä–æ–Ω' in category_name or 'dron' in category_name or '–∫–≤–∞–¥—Ä–æ–∫–æ–ø—Ç–µ—Ä' in category_name
            else 'cnc' if '—á–ø—É' in category_name or 'cnc' in category_name or '—Å—Ç–∞–Ω–æ–∫' in category_name or '—Ñ—Ä–µ–∑–µ—Ä' in category_name
            else 'other'
        %}
        
        <div class="equipment-card" data-category="{{ category_filter }}" data-name="{{ item.name.lower() }}">
            <div class="card-image">
                <div class="category-badge {{ category_filter }}">
                    <i class="fas fa-{{ 
                        'desktop' if category_filter == 'workstation' 
                        else 'print' if category_filter == '3d'
                        else 'robot' if category_filter == 'robots'
                        else 'helicopter' if category_filter == 'drones'
                        else 'cog' if category_filter == 'cnc'
                        else 'cube'
                    }}"></i>
                    {{ item.category.name if item.category else '–î—Ä—É–≥–æ–µ' }}
                </div>
                {% if item.image_url %}
                <img src="{{ item.image_url }}" 
                     alt="{{ item.name }}" 
                     onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                {% endif %}
                <div class="image-placeholder" {% if item.image_url %}style="display: none;"{% endif %}>
                    <i class="fas fa-{{ 
                        'desktop' if category_filter == 'workstation' 
                        else 'print' if category_filter == '3d'
                        else 'robot' if category_filter == 'robots'
                        else 'helicopter' if category_filter == 'drones'
                        else 'cog' if category_filter == 'cnc'
                        else 'cube'
                    }}"></i>
                </div>
                <div class="card-overlay">
                    <div class="status-indicator {% if item.is_available %}available{% else %}busy{% endif %}"></div>
                    {% if user and user.role != 'admin' %}
                    <button class="favorite-btn" data-equipment-id="{{ item.id }}">
                        <i class="far fa-heart"></i>
                    </button>
                    {% endif %}
                </div>
            </div>
            <div class="card-content">
                <h3 class="equipment-title">{{ item.name }}</h3>
                <p class="equipment-description">{{ item.description }}</p>
                
                <div class="specs-preview">
                    {% if item.specifications %}
                        {% set specs = item.specifications %}
                        {% if specs is string %}
                            {% set specs = {} %}
                        {% endif %}
                        {% for key, value in specs.items() %}
                            {% if loop.index <= 3 %}
                            <div class="spec-tag">
                                <i class="fas fa-info-circle"></i>
                                {{ key }}: {{ value }}
                            </div>
                            {% endif %}
                        {% endfor %}
                    {% else %}
                    <div class="spec-tag">
                        <i class="fas fa-info-circle"></i>
                        –î–µ—Ç–∞–ª–∏ –≤ –æ–ø–∏—Å–∞–Ω–∏–∏
                    </div>
                    {% endif %}
                </div>
                
                <div class="card-actions">
                    {% if item.is_available %}
                    <a href="{{ url_for('booking') }}?equipment_id={{ item.id }}" class="btn btn-primary btn-book">
                        <i class="fas fa-calendar-plus"></i>
                        –ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å
                    </a>
                    {% else %}
                    <button class="btn btn-primary btn-book" disabled>
                        <i class="fas fa-clock"></i>
                        –ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ
                    </button>
                    {% endif %}
                    <a href="{{ url_for('equipment_detail', equipment_id=item.id) }}" class="btn btn-outline">
                        <i class="fas fa-info-circle"></i>
                        –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                    </a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ -->
{% if user and user.role == 'admin' %}
<div id="addEquipmentModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3><i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</h3>
            <span class="close" onclick="closeAddEquipmentModal()">&times;</span>
        </div>
        <form id="addEquipmentForm" class="modal-form">
            <div class="form-group">
                <label>–ù–∞–∑–≤–∞–Ω–∏–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è:</label>
                <input type="text" name="name" required>
            </div>
            <div class="form-group">
                <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label>
                <select name="category" required>
                    <option value="workstation">–†–∞–±–æ—á–µ–µ –º–µ—Å—Ç–æ</option>
                    <option value="3d">3D-–ø–µ—á–∞—Ç—å</option>
                    <option value="robots">–†–æ–±–æ–º–∞–Ω–∏–ø—É–ª—è—Ç–æ—Ä</option>
                    <option value="drones">–ë–ü–õ–ê</option>
                    <option value="cnc">–ß–ü–£ —Å—Ç–∞–Ω–æ–∫</option>
                </select>
            </div>
            <div class="form-group">
                <label>–û–ø–∏—Å–∞–Ω–∏–µ:</label>
                <textarea name="description" rows="3" required></textarea>
            </div>
            <div class="form-group">
                <label>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ (JSON):</label>
                <textarea name="specifications" rows="4" placeholder='{"–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä": "Intel i7", "–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å": "16GB"}'></textarea>
            </div>
            <div class="form-group">
                <label>URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:</label>
                <input type="text" name="image_url" placeholder="https://example.com/image.jpg">
            </div>
            <div class="form-actions">
                <button type="button" class="btn btn-secondary" onclick="closeAddEquipmentModal()">–û—Ç–º–µ–Ω–∞</button>
                <button type="submit" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</button>
            </div>
        </form>
    </div>
</div>

<div id="maintenanceModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3><i class="fas fa-tools"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ–º</h3>
            <span class="close" onclick="closeMaintenanceModal()">&times;</span>
        </div>
        <div class="modal-form">
            <div class="form-group">
                <label>–í—ã–±–µ—Ä–∏—Ç–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è:</label>
                <select id="maintenanceEquipmentSelect">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ...</option>
                    {% for item in items %}
                    <option value="{{ item.id }}">{{ item.name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="form-group">
                <label>–ü—Ä–∏—á–∏–Ω–∞ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è:</label>
                <textarea id="maintenanceReason" rows="3" placeholder="–£–∫–∞–∂–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è..."></textarea>
            </div>
            <div class="form-group">
                <label>–û–∂–∏–¥–∞–µ–º–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–¥–Ω–µ–π):</label>
                <input type="number" id="maintenanceDuration" min="1" max="30" value="3">
            </div>
            <div class="form-actions">
                <button type="button" class="btn btn-secondary" onclick="closeMaintenanceModal()">–û—Ç–º–µ–Ω–∞</button>
                <button type="button" class="btn btn-warning" onclick="sendToMaintenance()">
                    <i class="fas fa-tools"></i> –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ
                </button>
            </div>
        </div>
    </div>
</div>

<div id="deleteConfirmModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3><i class="fas fa-exclamation-triangle"></i> –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è</h3>
            <span class="close" onclick="closeDeleteModal()">&times;</span>
        </div>
        <div class="modal-form">
            <p id="deleteConfirmText">–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ?</p>
            <div class="form-actions">
                <button type="button" class="btn btn-secondary" onclick="closeDeleteModal()">–û—Ç–º–µ–Ω–∞</button>
                <button type="button" class="btn btn-danger" id="confirmDeleteBtn">
                    <i class="fas fa-trash"></i> –£–¥–∞–ª–∏—Ç—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
                </button>
            </div>
        </div>
    </div>
</div>
{% endif %}

<style>
/* –°—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π, –∫–∞–∫ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –∫–æ–¥–µ */
.admin-panel {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 15px;
    padding: 2rem;
    margin-bottom: 2rem;
    color: white;
    box-shadow: 0 8px 32px rgba(0,0,0,0.1);
}

.admin-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
    flex-wrap: wrap;
    gap: 1rem;
}

.admin-header h2 {
    margin: 0;
    font-size: 1.5rem;
}

.admin-stats {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
}

.admin-badge {
    background: rgba(255,255,255,0.2);
    padding: 0.5rem 1rem;
    border-radius: 20px;
    font-size: 0.9rem;
    backdrop-filter: blur(10px);
}

.admin-controls {
    display: flex;
    gap: 1rem;
    margin-bottom: 1.5rem;
    flex-wrap: wrap;
}

.btn-admin {
    background: rgba(255,255,255,0.9);
    color: #667eea;
    border: none;
    padding: 0.75rem 1.5rem;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    text-decoration: none;
}

.btn-admin:hover {
    background: white;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
}

.btn-export {
    background: rgba(40, 167, 69, 0.9);
    color: white;
}

.quick-actions {
    background: rgba(255,255,255,0.1);
    padding: 1.5rem;
    border-radius: 10px;
    backdrop-filter: blur(10px);
}

.quick-actions h3 {
    margin: 0 0 1rem 0;
    font-size: 1.1rem;
}

.equipment-controls {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.equipment-control-item {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 0.75rem;
    background: rgba(255,255,255,0.1);
    border-radius: 8px;
    transition: all 0.3s ease;
}

.equipment-control-item:hover {
    background: rgba(255,255,255,0.15);
}

.equipment-name {
    flex: 1;
    font-weight: 500;
}

.status-select {
    padding: 0.5rem;
    border-radius: 6px;
    border: none;
    background: white;
    color: #333;
    min-width: 120px;
}

.btn-sm {
    padding: 0.4rem 0.8rem;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.8rem;
    transition: all 0.3s ease;
}

.btn-edit {
    background: #ffc107;
    color: white;
}

.btn-edit:hover {
    background: #e0a800;
    transform: scale(1.05);
}

.btn-delete {
    background: #dc3545;
    color: white;
}

.btn-delete:hover {
    background: #c82333;
    transform: scale(1.05);
}

.btn-warning {
    background: #ffc107;
    color: #212529;
    border: none;
    padding: 0.75rem 1.5rem;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    transition: all 0.3s ease;
}

.btn-warning:hover {
    background: #e0a800;
}

.modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.5);
}

.modal-content {
    background-color: white;
    margin: 5% auto;
    padding: 0;
    border-radius: 15px;
    width: 90%;
    max-width: 600px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    max-height: 90vh;
    overflow-y: auto;
}

.modal-header {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    padding: 1.5rem;
    border-radius: 15px 15px 0 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: sticky;
    top: 0;
    z-index: 1;
}

.modal-header h3 {
    margin: 0;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.close {
    font-size: 2rem;
    cursor: pointer;
    transition: opacity 0.3s ease;
}

.close:hover {
    opacity: 0.7;
}

.modal-form {
    padding: 2rem;
}

.form-group {
    margin-bottom: 1.5rem;
}

.form-group label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 600;
    color: #333;
}

.form-group input,
.form-group select,
.form-group textarea {
    width: 100%;
    padding: 0.75rem;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    font-size: 1rem;
    transition: border-color 0.3s ease;
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
    outline: none;
    border-color: #667eea;
}

.form-actions {
    display: flex;
    gap: 1rem;
    justify-content: flex-end;
    margin-top: 2rem;
}

.btn-secondary {
    background: #6c757d;
    color: white;
    border: none;
    padding: 0.75rem 1.5rem;
    border-radius: 8px;
    cursor: pointer;
}

.btn-primary {
    background: #667eea;
    color: white;
    border: none;
    padding: 0.75rem 1.5rem;
    border-radius: 8px;
    cursor: pointer;
}

.btn-danger {
    background: #dc3545;
    color: white;
    border: none;
    padding: 0.75rem 1.5rem;
    border-radius: 8px;
    cursor: pointer;
}

.stat-icon.total {
    background: #e3f2fd;
    color: #1976d2;
}

.equipment-catalog {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 1rem;
}

.catalog-header {
    text-align: center;
    margin-bottom: 3rem;
}

.catalog-header h1 {
    font-size: 2.5rem;
    margin-bottom: 0.5rem;
    background: linear-gradient(135deg, #667eea, #764ba2);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.catalog-description {
    font-size: 1.1rem;
    color: #666;
    max-width: 600px;
    margin: 0 auto;
}

.category-filters {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
    gap: 2rem;
    flex-wrap: wrap;
}

.filter-buttons {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
}

.filter-btn {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1.5rem;
    border: 2px solid #e0e0e0;
    background: white;
    border-radius: 50px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: 500;
    color: #666;
}

.filter-btn:hover {
    border-color: #667eea;
    color: #667eea;
    transform: translateY(-2px);
}

.filter-btn.active {
    background: linear-gradient(135deg, #667eea, #764ba2);
    border-color: #667eea;
    color: white;
}

.search-box {
    position: relative;
    min-width: 300px;
}

.search-box i {
    position: absolute;
    left: 1rem;
    top: 50%;
    transform: translateY(-50%);
    color: #999;
}

.search-box input {
    width: 100%;
    padding: 0.75rem 1rem 0.75rem 3rem;
    border: 2px solid #e0e0e0;
    border-radius: 50px;
    font-size: 1rem;
    transition: border-color 0.3s ease;
}

.search-box input:focus {
    outline: none;
    border-color: #667eea;
}

.equipment-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 1rem;
    margin-bottom: 2rem;
}

.stat-card {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1.5rem;
    background: white;
    border-radius: 12px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.stat-icon {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
}

.stat-icon.available {
    background: #e8f5e8;
    color: #28a745;
}

.stat-icon.busy {
    background: #ffe8e8;
    color: #dc3545;
}

.stat-icon.total {
    background: #e3f2fd;
    color: #1976d2;
}

.stat-number {
    font-size: 1.5rem;
    font-weight: bold;
    color: #333;
    display: block;
}

.stat-label {
    color: #666;
    font-size: 0.9rem;
}

.equipment-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
    gap: 2rem;
}

.equipment-card {
    background: white;
    border-radius: 20px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    transition: all 0.3s ease;
    overflow: hidden;
    position: relative;
}

.equipment-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 12px 40px rgba(0,0,0,0.15);
}

.card-image {
    position: relative;
    height: 200px;
    background: linear-gradient(135deg, #667eea, #764ba2);
    display: flex;
    align-items: center;
    justify-content: center;
}

.card-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.category-badge {
    position: absolute;
    top: 1rem;
    left: 1rem;
    padding: 0.5rem 1rem;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 600;
    color: white;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    backdrop-filter: blur(10px);
    background: rgba(255,255,255,0.2);
}

.category-badge.workstation { background: rgba(102, 126, 234, 0.9); }
.category-badge.printing { background: rgba(40, 167, 69, 0.9); }
.category-badge.robots { background: rgba(255, 193, 7, 0.9); }
.category-badge.drones { background: rgba(0, 123, 255, 0.9); }
.category-badge.cnc { background: rgba(108, 117, 125, 0.9); }

.image-placeholder {
    font-size: 4rem;
    color: rgba(255,255,255,0.9);
}

.card-overlay {
    position: absolute;
    top: 1rem;
    right: 1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.status-indicator {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    border: 2px solid white;
}

.status-indicator.available { background: #28a745; }
.status-indicator.busy { background: #dc3545; }

.favorite-btn {
    background: rgba(255, 255, 255, 0.9);
    border: none;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    color: #dc3545;
    transition: all 0.3s ease;
    box-shadow: 0 2px 8px rgba(0,0,0,0.15);
}

.favorite-btn:hover {
    background: white;
    transform: scale(1.1);
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
}

.favorite-btn.favorited {
    color: #dc3545;
    background: white;
}

.favorite-btn.favorited i {
    font-weight: 900;
}

.card-content {
    padding: 1.5rem;
}

.equipment-title {
    font-size: 1.3rem;
    margin-bottom: 0.75rem;
    color: #2c3e50;
    line-height: 1.3;
}

.equipment-description {
    color: #666;
    margin-bottom: 1.5rem;
    line-height: 1.5;
    font-size: 0.95rem;
}

.specs-preview {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-bottom: 1.5rem;
}

.spec-tag {
    display: flex;
    align-items: center;
    gap: 0.4rem;
    padding: 0.4rem 0.8rem;
    background: #f8f9fa;
    border-radius: 15px;
    font-size: 0.8rem;
    color: #495057;
    font-weight: 500;
}

.spec-tag i {
    font-size: 0.7rem;
    color: #667eea;
}

.card-actions {
    display: flex;
    gap: 0.75rem;
}

.btn {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1.5rem;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    text-decoration: none;
    transition: all 0.3s ease;
    text-align: center;
}

.btn-primary {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
}

.btn-outline {
    background: transparent;
    border: 2px solid #667eea;
    color: #667eea;
}

.btn-outline:hover {
    background: #667eea;
    color: white;
}

.btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none !important;
}

.btn-book {
    flex: 2;
    justify-content: center;
}

.btn-outline {
    flex: 1;
    justify-content: center;
}

@media (max-width: 768px) {
    .category-filters {
        flex-direction: column;
        align-items: stretch;
    }
    
    .filter-buttons {
        justify-content: center;
    }
    
    .search-box {
        min-width: auto;
    }
    
    .equipment-grid {
        grid-template-columns: 1fr;
    }
    
    .equipment-stats {
        grid-template-columns: repeat(3, 1fr);
    }
    
    .card-overlay {
        flex-direction: column;
        gap: 0.3rem;
    }
    
    .favorite-btn {
        width: 35px;
        height: 35px;
        font-size: 1rem;
    }
    
    .admin-header {
        flex-direction: column;
        align-items: stretch;
    }
    
    .admin-controls {
        flex-direction: column;
    }
    
    .equipment-control-item {
        flex-direction: column;
        align-items: stretch;
        gap: 0.75rem;
    }
    
    .admin-stats {
        justify-content: center;
    }
    
    .form-actions {
        flex-direction: column;
    }
}

.no-results {
    grid-column: 1 / -1;
    text-align: center;
    padding: 3rem;
    color: #666;
}

.no-results i {
    font-size: 3rem;
    margin-bottom: 1rem;
    opacity: 0.5;
}

.no-results h3 {
    margin-bottom: 0.5rem;
    color: #333;
}
</style>

<script>
// –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
let equipmentToDelete = null;

// ========== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –ú–û–î–ê–õ–¨–ù–´–• –û–ö–û–ù ==========
function showAddEquipmentModal() {
    document.getElementById('addEquipmentModal').style.display = 'block';
}

function closeAddEquipmentModal() {
    document.getElementById('addEquipmentModal').style.display = 'none';
    document.getElementById('addEquipmentForm').reset();
}

function showMaintenanceModal() {
    document.getElementById('maintenanceModal').style.display = 'block';
}

function closeMaintenanceModal() {
    document.getElementById('maintenanceModal').style.display = 'none';
    document.getElementById('maintenanceEquipmentSelect').value = '';
    document.getElementById('maintenanceReason').value = '';
    document.getElementById('maintenanceDuration').value = '3';
}

function closeDeleteModal() {
    document.getElementById('deleteConfirmModal').style.display = 'none';
    equipmentToDelete = null;
}

// ========== –§–£–ù–ö–¶–ò–ò –ê–î–ú–ò–ù–ò–°–¢–†–ò–†–û–í–ê–ù–ò–Ø ==========
async function updateEquipmentStatus(equipmentId, newStatus) {
    try {
        showNotification('üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞...', 'info');
        
        const formData = new FormData();
        formData.append('status', newStatus);
        
        const response = await fetch(`/admin/equipment/${equipmentId}/status`, {
            method: 'POST',
            body: formData
        });
        
        const result = await response.json();
        
        if (result.success) {
            showNotification('‚úÖ –°—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª–µ–Ω', 'success');
            location.reload();
        } else {
            throw new Error(result.error || '–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞');
        }
        
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞:', error);
        showNotification('‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞', 'error');
    }
}

async function sendToMaintenance() {
    const equipmentId = document.getElementById('maintenanceEquipmentSelect').value;
    const reason = document.getElementById('maintenanceReason').value;
    const duration = document.getElementById('maintenanceDuration').value;
    
    if (!equipmentId) {
        showNotification('‚ùå –í—ã–±–µ—Ä–∏—Ç–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ', 'error');
        return;
    }
    
    if (!reason.trim()) {
        showNotification('‚ùå –£–∫–∞–∂–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è', 'error');
        return;
    }
    
    try {
        showNotification('üõ†Ô∏è –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ...', 'info');
        
        const formData = new FormData();
        formData.append('reason', reason);
        formData.append('duration', duration);
        
        const response = await fetch(`/admin/equipment/${equipmentId}/maintenance`, {
            method: 'POST',
            body: formData
        });
        
        const result = await response.json();
        
        if (result.success) {
            showNotification('‚úÖ –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ', 'success');
            closeMaintenanceModal();
            location.reload();
        } else {
            throw new Error(result.error || '–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–∞ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ');
        }
        
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–∞ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ:', error);
        showNotification('‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–∞ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ', 'error');
    }
}

function confirmDeleteEquipment(equipmentId, equipmentName) {
    equipmentToDelete = equipmentId;
    document.getElementById('deleteConfirmText').textContent = 
        `–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ "${equipmentName}"? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.`;
    document.getElementById('deleteConfirmModal').style.display = 'block';
}

async function deleteEquipment() {
    if (!equipmentToDelete) return;
    
    try {
        showNotification('üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è...', 'warning');
        
        const response = await fetch(`/admin/equipment/${equipmentToDelete}/delete`, {
            method: 'POST'
        });
        
        const result = await response.json();
        
        if (result.success) {
            showNotification('‚úÖ –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ', 'success');
            closeDeleteModal();
            location.reload();
        } else {
            throw new Error(result.error || '–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è');
        }
        
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è:', error);
        showNotification('‚ùå –û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è', 'error');
    }
}

function editEquipment(equipmentId) {
    window.location.href = `/admin/equipment/${equipmentId}/edit`;
}

function exportEquipmentData() {
    showNotification('üìä –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ...', 'info');
    const link = document.createElement('a');
    link.href = '/admin/equipment/export';
    link.download = 'equipment_export.csv';
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    setTimeout(() => {
        showNotification('‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã', 'success');
    }, 1500);
}

// ========== –û–ë–†–ê–ë–û–¢–ö–ê –§–û–†–ú ==========
document.getElementById('addEquipmentForm')?.addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const formData = new FormData(this);
    
    try {
        showNotification('üì¶ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è...', 'info');
        
        const response = await fetch('/admin/equipment/quick-add', {
            method: 'POST',
            body: formData
        });
        
        const result = await response.json();
        
        if (result.success) {
            showNotification('‚úÖ –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ', 'success');
            closeAddEquipmentModal();
            location.reload();
        } else {
            throw new Error(result.error || '–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è');
        }
        
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è:', error);
        showNotification('‚ùå –û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è', 'error');
    }
});

// ========== –§–ò–õ–¨–¢–†–ê–¶–ò–Ø –ò –ü–û–ò–°–ö ==========
function initializeFiltering() {
    const filterButtons = document.querySelectorAll('.filter-btn');
    const equipmentCards = document.querySelectorAll('.equipment-card');
    const searchInput = document.getElementById('equipmentSearch');
    
    // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
    filterButtons.forEach(button => {
        button.addEventListener('click', function() {
            const category = this.getAttribute('data-category');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
            filterButtons.forEach(btn => btn.classList.remove('active'));
            this.classList.add('active');
            
            // –§–∏–ª—å—Ç—Ä—É–µ–º –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
            filterEquipment(category, searchInput.value.toLowerCase());
        });
    });
    
    // –ü–æ–∏—Å–∫
    searchInput.addEventListener('input', function() {
        const searchTerm = this.value.toLowerCase();
        const activeCategory = document.querySelector('.filter-btn.active').getAttribute('data-category');
        filterEquipment(activeCategory, searchTerm);
    });
    
    function filterEquipment(category, searchTerm) {
        let visibleCount = 0;
        
        equipmentCards.forEach(card => {
            const cardCategory = card.getAttribute('data-category');
            const cardName = card.getAttribute('data-name');
            const cardText = card.textContent.toLowerCase();
            
            const categoryMatch = category === 'all' || cardCategory === category;
            const searchMatch = searchTerm === '' || 
                              cardName.includes(searchTerm) || 
                              cardText.includes(searchTerm);
            
            if (categoryMatch && searchMatch) {
                card.style.display = 'block';
                visibleCount++;
                
                // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                
                setTimeout(() => {
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, 50);
            } else {
                // –ê–Ω–∏–º–∞—Ü–∏—è –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                
                setTimeout(() => {
                    card.style.display = 'none';
                }, 300);
            }
        });
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ, –µ—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
        showNoResultsMessage(visibleCount === 0);
    }
    
    function showNoResultsMessage(show) {
        let message = document.getElementById('noResultsMessage');
        
        if (show && !message) {
            message = document.createElement('div');
            message.id = 'noResultsMessage';
            message.className = 'no-results';
            message.innerHTML = `
                <div style="text-align: center; padding: 3rem; color: #666;">
                    <i class="fas fa-search" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                    <h3>–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h3>
                    <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞ –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏</p>
                </div>
            `;
            document.getElementById('equipmentGrid').appendChild(message);
        } else if (!show && message) {
            message.remove();
        }
    }
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏
    equipmentCards.forEach((card, index) => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(20px)';
        card.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
        
        setTimeout(() => {
            card.style.opacity = '1';
            card.style.transform = 'translateY(0)';
        }, index * 100);
    });
}

// ========== –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø ==========
function showNotification(message, type = 'info') {
    const notification = document.createElement('div');
    notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 1rem 1.5rem;
        border-radius: 8px;
        color: white;
        font-weight: 500;
        z-index: 10000;
        max-width: 300px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        transform: translateX(400px);
        transition: transform 0.3s ease;
    `;
    
    // –¶–≤–µ—Ç–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
    const colors = {
        success: 'linear-gradient(135deg, #28a745, #20c997)',
        error: 'linear-gradient(135deg, #dc3545, #e83e8c)',
        warning: 'linear-gradient(135deg, #ffc107, #fd7e14)',
        info: 'linear-gradient(135deg, #667eea, #764ba2)'
    };
    
    notification.style.background = colors[type] || colors.info;
    notification.textContent = message;
    
    document.body.appendChild(notification);
    
    // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
    setTimeout(() => {
        notification.style.transform = 'translateX(0)';
    }, 100);
    
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫—Ä—ã—Ç–∏–µ
    setTimeout(() => {
        notification.style.transform = 'translateX(400px)';
        setTimeout(() => {
            if (notification.parentNode) {
                notification.parentNode.removeChild(notification);
            }
        }, 300);
    }, 4000);
}

// ========== –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–ë–´–¢–ò–ô ==========
document.addEventListener('DOMContentLoaded', function() {
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
    initializeFiltering();
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–∏—è
    document.getElementById('confirmDeleteBtn')?.addEventListener('click', deleteEquipment);
    
    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –∏—Ö
    window.addEventListener('click', function(event) {
        const modals = document.querySelectorAll('.modal');
        modals.forEach(modal => {
            if (event.target === modal) {
                modal.style.display = 'none';
                if (modal.id === 'deleteConfirmModal') {
                    equipmentToDelete = null;
                }
            }
        });
    });
    
    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø–æ ESC
    document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                modal.style.display = 'none';
            });
            equipmentToDelete = null;
        }
    });
});
</script>

{% endblock %}